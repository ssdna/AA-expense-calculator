# AA制费用计算器测试文件说明

## 📁 文件结构

```
tests/
├── test-data-1.xlsx          # 测试数据文件1
├── test-data-2.xlsx          # 测试数据文件2  
├── test-data-3.xlsx          # 测试数据文件3
├── test-data-4.xlsx          # 测试数据文件4
├── test-data-5.xlsx          # 测试数据文件5
├── validation-report.md      # 详细验证报告
├── generate-test-data.js     # 测试数据生成脚本
├── manual-verification.js   # 手动验证脚本
└── README.md                # 本说明文件
```

## 🎯 测试目标

验证AA制费用计算器的以下功能：
1. **个人费用汇总计算**：每个人的已支付金额、应分摊金额、余额
2. **总费用平衡验证**：所有人的余额总和应为0
3. **结算方案准确性**：最优转账方案能够完全平衡所有账目
4. **Excel导入功能**：正确解析Excel文件格式

## 📊 测试数据特征

每个测试文件包含：
- **人员数量**：3-10人（随机生成）
- **费用记录**：10-100条（随机生成）
- **真实场景**：涵盖餐饮、交通、娱乐、购物、旅游等多种费用类型
- **复杂分摊**：支持任意人员组合的费用分摊

## 🔍 验证方法

### 自动验证
运行验证脚本：
```bash
node tests/manual-verification.js
```

### 手动验证步骤
1. 在计算器中点击"导入Excel文件"
2. 选择任意测试文件（test-data-1.xlsx ~ test-data-5.xlsx）
3. 导入后检查：
   - 人员列表是否正确显示
   - 费用记录是否完整导入
   - 个人费用汇总是否准确
   - 结算方案是否合理

### 验证要点
- ✅ **总支付 = 总费用**：所有人支付的总金额应等于所有费用的总和
- ✅ **总分摊 = 总费用**：所有人应分摊的总金额应等于所有费用的总和  
- ✅ **总余额 = 0**：所有人余额的代数和应为0
- ✅ **结算后平衡**：按结算方案转账后，所有人余额应为0

## 📈 计算公式验证

### 个人已支付金额
```
个人已支付 = Σ(该人作为支付人的所有费用金额)
```

### 个人应分摊金额  
```
个人应分摊 = Σ(该人参与分摊的费用金额 ÷ 该费用的分摊人数)
```

### 个人余额
```
个人余额 = 个人已支付 - 个人应分摊
```
- 正数：该人多付了，应收回
- 负数：该人少付了，应补交
- 零：该人收支平衡

### 结算算法
采用贪心算法，每次选择债权人和债务人中金额最小的进行结算，确保转账次数最少。

## 🎯 使用建议

1. **导入测试**：依次导入5个测试文件，验证导入功能
2. **计算验证**：对比计算器显示结果与validation-report.md中的预期结果
3. **边界测试**：关注小数点精度、零余额处理等边界情况
4. **交互测试**：尝试编辑、删除导入的数据，验证数据一致性

## 🔧 重新生成测试数据

如需重新生成测试数据：
```bash
node tests/generate-test-data.js
```

这将生成新的随机测试数据并覆盖现有文件。
